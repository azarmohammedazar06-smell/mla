<!-- MLA Public Help Portal with Language Toggle -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>YOUR MLA — Public Help Portal</title>
  <style>
    :root{
      --bg1:#c9ccd3; --bg2:#dbdee4; --card:#fff; --primary:#0078d7; --text:#111;
      --muted:#556; --danger:#d9534f;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:"Segoe UI", Roboto, Arial, sans-serif;
      background:linear-gradient(180deg,var(--bg1) 0%,var(--bg2) 100%);
      color:var(--text);
    }
    .container{max-width:980px;margin:28px auto;padding:20px;}
    header{display:flex;gap:16px;align-items:center;justify-content:space-between;flex-wrap:wrap}
    h1{color:var(--primary);margin:0;font-size:22px}
    .subtitle{color:var(--muted);font-size:13px;margin-top:4px}
    .controls{display:flex;gap:10px;flex-wrap:wrap}
    button{
      border:0;padding:10px 14px;border-radius:8px;background:var(--primary);color:#fff;
      cursor:pointer;font-size:14px;box-shadow:0 6px 14px rgba(0,0,0,0.08);
      transition:transform 0.1s;
    }
    button:hover{transform:scale(1.05)}
    button.ghost{background:#fff;color:var(--primary);border:1px solid rgba(0,0,0,0.06)}
    button.warn{background:var(--danger)}
    select.lang{
      padding:8px 10px;border-radius:8px;border:1px solid #ccc;background:#fff;
      font-size:14px;cursor:pointer;
    }
    main{display:grid;grid-template-columns:1fr;gap:18px;margin-top:18px}
    .card{background:var(--card);border-radius:12px;padding:18px;box-shadow:0 6px 18px rgba(12,20,30,0.06)}
    .form-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .full{grid-column:1/-1}
    label{font-weight:500;margin-bottom:4px;display:block}
    textarea,input,select{
      width:100%;padding:8px 10px;border-radius:6px;border:1px solid #ccc;font-size:14px;
    }
    .thumb,.vid-thumb{border-radius:6px;border:1px solid #eee;margin-top:6px}
    .thumb{width:84px;height:64px;object-fit:cover}
    .vid-thumb{width:120px;height:80px;object-fit:cover}
    @media(max-width:640px){ .form-grid{grid-template-columns:1fr} }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1 id="title">YOUR MLA — Public Help Portal</h1>
        <div class="subtitle" id="subtitle">Report public issues — saved locally & sent via WhatsApp</div>
      </div>
      <div class="controls">
        <select id="langSelect" class="lang" onchange="changeLang(this.value)">
          <option value="en">English</option>
          <option value="kn">ಕನ್ನಡ</option>
        </select>
        <button onclick="showSection('form')" id="btnReport">Report an Issue</button>
        <button class="ghost" onclick="showSection('about')" id="btnAbout">About / Plans</button>
        <button class="ghost" onclick="showSection('list')" id="btnList">View All Complaints</button>
      </div>
    </header>

    <main id="main"></main>
  </div>

  <script>
    const WHATSAPP_NUMBER = "919483927300";
    const STORAGE_KEY = "mla_complaints_v3";
    let currentLang = "en";

    const langData = {
      en: {
        title: "YOUR MLA — Public Help Portal",
        subtitle: "Report public issues — saved locally & sent via WhatsApp",
        report: "Report an Issue",
        about: "About / Plans",
        list: "View All Complaints",
        reportTitle: "Report a Public Issue",
        reportDesc: "Fill details below — you can save & send via WhatsApp.",
        category: "Issue Category",
        desc: "Describe the Issue",
        age: "Your Age Group",
        contactMethod: "Preferred Contact Method (optional)",
        contactInfo: "Contact Info (optional)",
        uploadImg: "Upload Image (optional)",
        uploadVid: "Upload Video (optional)",
        submit: "Save & Open WhatsApp",
        aboutTitle: "About",
        aboutText: "This portal helps citizens report public issues directly to MLA’s office through WhatsApp.",
        noComplaints: "No complaints yet.",
        saved: "Complaint saved. Open WhatsApp?"
      },
      kn: {
        title: "ನಿಮ್ಮ ಶಾಸಕರು — ಸಾರ್ವಜನಿಕ ಸಹಾಯ ಪೋರ್ಟಲ್",
        subtitle: "ಸಾರ್ವಜನಿಕ ಸಮಸ್ಯೆಗಳನ್ನು ವರದಿ ಮಾಡಿ — ಸ್ಥಳೀಯವಾಗಿ ಉಳಿಸಿ ಮತ್ತು ವಾಟ್ಸಾಪ್ ಮೂಲಕ ಕಳುಹಿಸಿ",
        report: "ಸಮಸ್ಯೆಯನ್ನು ವರದಿ ಮಾಡಿ",
        about: "ಬಗ್ಗೆ / ಯೋಜನೆಗಳು",
        list: "ಎಲ್ಲ ದೂರುಗಳನ್ನು ನೋಡಿ",
        reportTitle: "ಸಾರ್ವಜನಿಕ ಸಮಸ್ಯೆಯನ್ನು ವರದಿ ಮಾಡಿ",
        reportDesc: "ಕೆಳಗಿನ ವಿವರಗಳನ್ನು ಭರ್ತಿ ಮಾಡಿ — ನೀವು ಉಳಿಸಿ ವಾಟ್ಸಾಪ್ ಮೂಲಕ ಕಳುಹಿಸಬಹುದು.",
        category: "ಸಮಸ್ಯೆಯ ವರ್ಗ",
        desc: "ಸಮಸ್ಯೆಯನ್ನು ವಿವರಿಸಿ",
        age: "ನಿಮ್ಮ ವಯೋಮಾನದ ಗುಂಪು",
        contactMethod: "ಆದ್ಯತೆಯ ಸಂಪರ್ಕ ವಿಧಾನ (ಐಚ್ಛಿಕ)",
        contactInfo: "ಸಂಪರ್ಕ ಮಾಹಿತಿ (ಐಚ್ಛಿಕ)",
        uploadImg: "ಚಿತ್ರವನ್ನು ಅಪ್‌ಲೋಡ್ ಮಾಡಿ (ಐಚ್ಛಿಕ)",
        uploadVid: "ವೀಡಿಯೊ ಅಪ್‌ಲೋಡ್ ಮಾಡಿ (ಐಚ್ಛಿಕ)",
        submit: "ಉಳಿಸಿ ಮತ್ತು ವಾಟ್ಸಾಪ್ ತೆರೆಯಿರಿ",
        aboutTitle: "ಬಗ್ಗೆ",
        aboutText: "ಈ ಪೋರ್ಟಲ್ ನಾಗರಿಕರಿಗೆ ಸಾರ್ವಜನಿಕ ಸಮಸ್ಯೆಗಳನ್ನು ನೇರವಾಗಿ ಶಾಸಕರ ಕಚೇರಿಗೆ ವಾಟ್ಸಾಪ್ ಮೂಲಕ ವರದಿ ಮಾಡಲು ಸಹಾಯ ಮಾಡುತ್ತದೆ.",
        noComplaints: "ಇನ್ನೂ ಯಾವುದೇ ದೂರುಗಳಿಲ್ಲ.",
        saved: "ದೂರು ಉಳಿಸಲಾಗಿದೆ. ವಾಟ್ಸಾಪ್ ತೆರೆಯುವಿರಾ?"
      }
    };

    function changeLang(lang){
      currentLang = lang;
      const t = langData[lang];
      document.getElementById("title").innerText = t.title;
      document.getElementById("subtitle").innerText = t.subtitle;
      document.getElementById("btnReport").innerText = t.report;
      document.getElementById("btnAbout").innerText = t.about;
      document.getElementById("btnList").innerText = t.list;
      showSection(currentSection);
    }

    function qs(s){return document.querySelector(s)}
    function el(t,a={},h=""){const e=document.createElement(t);Object.assign(e,a);if(h)e.innerHTML=h;return e;}
    function nowISO(){return new Date().toISOString()}
    function formatDate(iso){return new Date(iso).toLocaleString()}
    function saveToStorage(l){localStorage.setItem(STORAGE_KEY,JSON.stringify(l))}
    function loadFromStorage(){try{return JSON.parse(localStorage.getItem(STORAGE_KEY)||"[]")}catch(e){return[]}}

    const main=qs("#main");
    let currentSection="form";
    function showSection(n){currentSection=n;main.innerHTML="";if(n==="about")return renderAbout();if(n==="list")return renderList();return renderForm();}

    function renderForm(){
      const t=langData[currentLang];
      const c=el("div",{className:"card"});
      c.innerHTML=`<h2>${t.reportTitle}</h2><p class="muted">${t.reportDesc}</p>`;
      const f=el("form",{className:"form-grid"});

      const categoryLabel=el("label",{innerText:t.category});
      const category=el("select");
      category.innerHTML=`<option value="">Select</option>
        <option>Health</option><option>Agriculture</option><option>Education</option>
        <option>Infrastructure</option><option>Other</option>`;

      const descBlock=el("div",{className:"full"});
      descBlock.innerHTML=`<label>${t.desc}</label>`;
      const desc=el("textarea",{placeholder:t.desc});
      descBlock.appendChild(desc);

      const ageLabel=el("label",{innerText:t.age});
      const age=el("select");
      age.innerHTML=`<option value="">Select</option><option>18–30</option><option>30–45</option><option>45+</option>`;

      const contactLabel=el("label",{innerText:t.contactMethod});
      const contact=el("select");
      contact.innerHTML=`<option value="">Select</option><option>Email</option><option>Phone</option><option>WhatsApp</option>`;

      const contactValLabel=el("label",{innerText:t.contactInfo});
      const contactVal=el("input",{type:"text",placeholder:t.contactInfo});

      const fileLabel=el("label",{innerText:t.uploadImg});
      const file=el("input",{type:"file",accept:"image/*"});

      const videoLabel=el("label",{innerText:t.uploadVid});
      const videoFile=el("input",{type:"file",accept:"video/*"});

      const submitWrap=el("div",{className:"full"});
      const btn=el("button",{type:"submit",innerText:t.submit});
      submitWrap.appendChild(btn);

      [categoryLabel,category,descBlock,ageLabel,age,contactLabel,contact,
       contactValLabel,contactVal,fileLabel,file,videoLabel,videoFile,submitWrap]
       .forEach(x=>f.appendChild(x));

      function readAsDataURL(fileObj){
        return new Promise((res,rej)=>{if(!fileObj)return res(null);const r=new FileReader();r.onload=()=>res(r.result);r.onerror=()=>rej();r.readAsDataURL(fileObj);});
      }

      f.onsubmit=async e=>{
        e.preventDefault();
        if(!category.value)return alert("Please select a category");
        if(!desc.value.trim())return alert("Please describe the issue");
        const imgFile=file.files[0],vidFile=videoFile.files[0];
        let imgData=null, vidData=null;
        if(imgFile){if(imgFile.size>1.6*1024*1024&&!confirm("Image is large, continue?"))return;imgData=await readAsDataURL(imgFile);}
        if(vidFile){if(vidFile.size>5*1024*1024&&!confirm("Video is large, continue?"))return;vidData=await readAsDataURL(vidFile);}
        const complaint={id:Math.random().toString(36).slice(2,9),createdAt:nowISO(),category:category.value,description:desc.value.trim(),ageGroup:age.value,contactMethod:contact.value,contactInfo:contactVal.value.trim(),imageData:imgData,videoData:vidData};
        const list=loadFromStorage();list.unshift(complaint);try{saveToStorage(list)}catch(e){alert("Storage full");return;}
        const msg=[`Complaint ID: ${complaint.id}`,`Category: ${complaint.category}`,`Description: ${complaint.description}`,complaint.ageGroup?`Age: ${complaint.ageGroup}`:"",complaint.contactMethod?`Contact via: ${complaint.contactMethod}`:"",complaint.contactInfo?`Contact info: ${complaint.contactInfo}`:"",complaint.videoData?"(Video attached locally)":"",complaint.imageData?"(Image attached locally)":"",`Submitted at: ${formatDate(complaint.createdAt)}`,"(Report sent from MLA Portal)"].filter(Boolean).join("\n");
        const wa=`https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(msg)}`;
        if(confirm(t.saved))window.open(wa,"_blank");
        f.reset();showSection('list');
      };

      c.appendChild(f);main.appendChild(c);
    }

    function renderList(){
      const t=langData[currentLang];
      const c=el("div",{className:"card"});
      c.innerHTML=`<h2>${t.list}</h2>`;
      const list=loadFromStorage();
      if(!list.length){c.innerHTML+=`<p>${t.noComplaints}</p>`;main.appendChild(c);return;}
      list.forEach(i=>{
        const row=el("div",{style:"border:1px dashed #ccc;padding:10px;margin:10px 0;border-radius:8px"});
        row.innerHTML=`<strong>${i.category}</strong><br>${i.description}<br><small>${formatDate(i.createdAt)}</small><br>`;
        if(i.imageData)row.appendChild(el("img",{src:i.imageData,className:"thumb"}));
        if(i.videoData){const v=el("video",{className:"vid-thumb",controls:true});v.src=i.videoData;row.appendChild(v);}
        c.appendChild(row);
      });
      main.appendChild(c);
    }

    function renderAbout(){
      const t=langData[currentLang];
      const c=el("div",{className:"card"});
      c.innerHTML=`<h2>${t.aboutTitle}</h2><p>${t.aboutText}</p>`;
      main.appendChild(c);
    }

    showSection('form');
  </script>
</body>
</html>
